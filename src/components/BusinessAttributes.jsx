import PropTypes from 'prop-types';
import './BusinessAttributes.css';

/**
 * Component to display business attributes from Google Places
 * (Restaurant features, parking, accessibility, EV charging, etc.)
 */
const BusinessAttributes = ({ business }) => {
  if (!business) return null;

  const {
    restaurantAttributes,
    parkingOptions,
    paymentOptions,
    accessibilityOptions,
    evChargeOptions,
    fuelOptions
  } = business;

  // Helper to check if any attribute is truthy in an object
  const hasAnyTrueAttribute = (obj) => {
    if (!obj) return false;
    return Object.values(obj).some(val => val === true || (val && typeof val === 'object'));
  };

  const showRestaurant = hasAnyTrueAttribute(restaurantAttributes);
  const showParking = parkingOptions !== null && parkingOptions !== undefined;
  const showPayment = paymentOptions !== null && paymentOptions !== undefined;
  const showAccessibility = hasAnyTrueAttribute(accessibilityOptions);
  const showEV = evChargeOptions !== null && evChargeOptions !== undefined;
  const showFuel = fuelOptions !== null && fuelOptions !== undefined;

  // If nothing to show, don't render
  if (!showRestaurant && !showParking && !showPayment && !showAccessibility && !showEV && !showFuel) {
    return null;
  }

  return (
    <div className="business-attributes">
      <h3>Attributs et services</h3>

      {/* Restaurant/Commerce Attributes */}
      {showRestaurant && (
        <div className="attribute-section">
          <h4>üçΩÔ∏è Services de restauration</h4>
          <div className="attribute-grid">
            {restaurantAttributes.dineIn && (
              <div className="attribute-item">‚úì Sur place</div>
            )}
            {restaurantAttributes.takeout && (
              <div className="attribute-item">‚úì Pour emporter</div>
            )}
            {restaurantAttributes.delivery && (
              <div className="attribute-item">‚úì Livraison</div>
            )}
            {restaurantAttributes.reservable && (
              <div className="attribute-item">‚úì R√©servations</div>
            )}
            {restaurantAttributes.outdoorSeating && (
              <div className="attribute-item">‚úì Terrasse ext√©rieure</div>
            )}
            {restaurantAttributes.liveMusic && (
              <div className="attribute-item">‚úì Musique live</div>
            )}
            {restaurantAttributes.goodForChildren && (
              <div className="attribute-item">‚úì Adapt√© aux enfants</div>
            )}
            {restaurantAttributes.goodForGroups && (
              <div className="attribute-item">‚úì Adapt√© aux groupes</div>
            )}
            {restaurantAttributes.servesVegetarianFood && (
              <div className="attribute-item">‚úì Options v√©g√©tariennes</div>
            )}
            {restaurantAttributes.servesBeer && (
              <div className="attribute-item">‚úì Bi√®re disponible</div>
            )}
            {restaurantAttributes.servesWine && (
              <div className="attribute-item">‚úì Vin disponible</div>
            )}
            {restaurantAttributes.servesBreakfast && (
              <div className="attribute-item">‚úì D√©jeuner</div>
            )}
            {restaurantAttributes.servesLunch && (
              <div className="attribute-item">‚úì D√Æner</div>
            )}
            {restaurantAttributes.servesDinner && (
              <div className="attribute-item">‚úì Souper</div>
            )}
            {restaurantAttributes.servesBrunch && (
              <div className="attribute-item">‚úì Brunch</div>
            )}
          </div>
        </div>
      )}

      {/* Parking Options */}
      {showParking && (
        <div className="attribute-section">
          <h4>üÖøÔ∏è Stationnement</h4>
          <div className="attribute-grid">
            {parkingOptions.free_parking && (
              <div className="attribute-item">‚úì Stationnement gratuit</div>
            )}
            {parkingOptions.paid_parking && (
              <div className="attribute-item">‚úì Stationnement payant</div>
            )}
            {parkingOptions.street_parking && (
              <div className="attribute-item">‚úì Stationnement dans la rue</div>
            )}
            {parkingOptions.parking_lot && (
              <div className="attribute-item">‚úì Stationnement</div>
            )}
            {parkingOptions.parking_garage && (
              <div className="attribute-item">‚úì Garage de stationnement</div>
            )}
            {parkingOptions.valet_parking && (
              <div className="attribute-item">‚úì Service de voiturier</div>
            )}
          </div>
        </div>
      )}

      {/* Payment Options */}
      {showPayment && (
        <div className="attribute-section">
          <h4>üí≥ Options de paiement</h4>
          <div className="attribute-grid">
            {paymentOptions.accepts_cash && (
              <div className="attribute-item">‚úì Argent comptant</div>
            )}
            {paymentOptions.accepts_credit_cards && (
              <div className="attribute-item">‚úì Cartes de cr√©dit</div>
            )}
            {paymentOptions.accepts_debit_cards && (
              <div className="attribute-item">‚úì Cartes de d√©bit</div>
            )}
            {paymentOptions.accepts_nfc && (
              <div className="attribute-item">‚úì Paiements sans contact (NFC)</div>
            )}
          </div>
        </div>
      )}

      {/* Accessibility Options */}
      {showAccessibility && (
        <div className="attribute-section">
          <h4>‚ôø Accessibilit√©</h4>
          <div className="attribute-grid">
            {accessibilityOptions.wheelchairAccessibleEntrance && (
              <div className="attribute-item">‚úì Entr√©e accessible en fauteuil roulant</div>
            )}
            {accessibilityOptions.wheelchair_accessible_parking && (
              <div className="attribute-item">‚úì Stationnement accessible</div>
            )}
            {accessibilityOptions.wheelchair_accessible_restroom && (
              <div className="attribute-item">‚úì Toilettes accessibles</div>
            )}
            {accessibilityOptions.wheelchair_accessible_seating && (
              <div className="attribute-item">‚úì Places assises accessibles</div>
            )}
          </div>
        </div>
      )}

      {/* EV Charging Options */}
      {showEV && evChargeOptions && (
        <div className="attribute-section">
          <h4>üîå Bornes de recharge √©lectrique</h4>
          <div className="attribute-grid">
            {evChargeOptions.has_ev_charging && (
              <div className="attribute-item">‚úì Bornes de recharge disponibles</div>
            )}
            {evChargeOptions.ev_connector_types && evChargeOptions.ev_connector_types.length > 0 && (
              <div className="attribute-item">
                Types: {evChargeOptions.ev_connector_types.join(', ')}
              </div>
            )}
          </div>
        </div>
      )}

      {/* Fuel Options */}
      {showFuel && fuelOptions && (
        <div className="attribute-section">
          <h4>‚õΩ Carburant</h4>
          <div className="attribute-grid">
            {fuelOptions.diesel && (
              <div className="attribute-item">‚úì Diesel</div>
            )}
            {fuelOptions.gasoline && (
              <div className="attribute-item">‚úì Essence</div>
            )}
            {fuelOptions.propane && (
              <div className="attribute-item">‚úì Propane</div>
            )}
            {fuelOptions.biodiesel && (
              <div className="attribute-item">‚úì Biodiesel</div>
            )}
            {fuelOptions.ethanol && (
              <div className="attribute-item">‚úì √âthanol</div>
            )}
          </div>
        </div>
      )}
    </div>
  );
};

BusinessAttributes.propTypes = {
  business: PropTypes.shape({
    restaurantAttributes: PropTypes.object,
    parkingOptions: PropTypes.object,
    paymentOptions: PropTypes.object,
    accessibilityOptions: PropTypes.object,
    evChargeOptions: PropTypes.object,
    fuelOptions: PropTypes.object
  })
};

export default BusinessAttributes;

# üîß Fix Mixed Content Error (HTTP vs HTTPS)

## Le probl√®me

Vous voyez cette erreur dans la console :
```
Mixed Content: The page at 'https://www.registreduquebec.com/...' was loaded over HTTPS,
but requested an insecure resource 'http://registreduquebec.com/api/...'.
This request has been blocked; the content must be served over HTTPS.
```

## ‚úÖ Solution IMM√âDIATE

### √âtape 1 : V√©rifier les variables d'environnement Vercel

1. Allez sur https://vercel.com/dashboard
2. S√©lectionnez votre projet `quebec-business-directory`
3. Allez dans **Settings ‚Üí Environment Variables**
4. **Cherchez `VITE_API_URL`**

### √âtape 2 : Supprimer VITE_API_URL (si elle existe)

**Si vous voyez `VITE_API_URL` dans la liste** :
1. Cliquez sur les **trois points** √† droite de la variable
2. Cliquez sur **Delete**
3. Confirmez la suppression

**Pourquoi ?** L'application d√©tecte automatiquement l'environnement et utilise `/api` (relatif) en production, ce qui √©vite les probl√®mes HTTP/HTTPS.

### √âtape 3 : V√©rifier les variables REQUISES

Assurez-vous que ces variables SONT pr√©sentes :

| ‚úÖ Variable | Description |
|------------|-------------|
| `VITE_SUPABASE_URL` | URL de votre projet Supabase |
| `VITE_SUPABASE_ANON_KEY` | Cl√© anonyme Supabase |
| `GOOGLE_PLACES_API_KEY` | Cl√© API Google Places |

### √âtape 4 : Red√©ployer

1. Allez dans **Deployments**
2. Cliquez sur les **trois points** du dernier d√©ploiement
3. Cliquez sur **Redeploy**

**OU attendez simplement le prochain push Git** - Vercel red√©ploiera automatiquement.

## üéØ Configuration correcte pour Vercel

### Variables √† D√âFINIR :
```
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGc...
GOOGLE_PLACES_API_KEY=AIzaSyD...
```

### Variables √† NE PAS D√âFINIR :
```
‚ùå VITE_API_URL (laissez vide - l'app d√©tecte automatiquement)
```

## üîç Comment √ßa fonctionne maintenant ?

Le code d√©tecte automatiquement l'environnement :

- **En production (Vercel)** : Utilise `/api` (chemin relatif = m√™me protocole que la page)
- **En d√©veloppement local** : Utilise `http://localhost:3001/api`

Le code force aussi HTTPS si `VITE_API_URL` contient `http://` en production.

## ‚úÖ V√©rification

Apr√®s le red√©ploiement, testez :

1. **Health check** : https://registreduquebec.com/api/google-places
   - Devrait retourner : `{"status":"ok","message":"Google Places API proxy is running"}`

2. **Import Google My Business** :
   - Allez sur votre site
   - Cr√©ez une nouvelle entreprise
   - Cliquez sur "Importer depuis Google"
   - Essayez d'importer une entreprise
   - ‚úÖ Aucune erreur "Mixed Content" ne devrait appara√Ætre

## üÜò Si √ßa ne fonctionne toujours pas

1. V√©rifiez les logs Vercel :
   - Dashboard ‚Üí Deployments ‚Üí Dernier d√©ploiement ‚Üí Functions
   - Cherchez les erreurs li√©es √† `google-places`

2. Testez l'API directement :
   ```bash
   curl https://registreduquebec.com/api/google-places
   ```

3. V√©rifiez la console du navigateur (F12) pour d'autres erreurs

4. Assurez-vous que `GOOGLE_PLACES_API_KEY` est bien configur√©e

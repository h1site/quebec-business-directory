# ‚úÖ Correction de la table business_claims

## Probl√®me
Erreur: `Could not find the 'user_email' column of 'business_claims' in the schema cache`

## Solution
La colonne `user_email` (et autres colonnes n√©cessaires) manquent dans la table `business_claims`. Vous devez ex√©cuter le script SQL pour les ajouter.

---

## Instructions (5 minutes)

### √âtape 1: Ouvrir Supabase
1. Allez sur https://supabase.com/dashboard
2. Connectez-vous √† votre compte
3. S√©lectionnez votre projet

### √âtape 2: Ouvrir l'√©diteur SQL
1. Dans le menu de gauche, cliquez sur **"SQL Editor"**
2. Cliquez sur **"New query"**

### √âtape 3: Copier-coller le script SQL
Copiez et collez le script suivant:

```sql
-- Ajouter la colonne user_email si elle n'existe pas d√©j√†
ALTER TABLE business_claims
ADD COLUMN IF NOT EXISTS user_email VARCHAR(255);

-- Ajouter les autres colonnes manquantes si n√©cessaire
ALTER TABLE business_claims
ADD COLUMN IF NOT EXISTS user_name VARCHAR(255);

ALTER TABLE business_claims
ADD COLUMN IF NOT EXISTS user_phone VARCHAR(50);

ALTER TABLE business_claims
ADD COLUMN IF NOT EXISTS verification_method VARCHAR(50);

ALTER TABLE business_claims
ADD COLUMN IF NOT EXISTS verification_data JSONB;

ALTER TABLE business_claims
ADD COLUMN IF NOT EXISTS notes TEXT;

-- V√©rifier la structure de la table
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'business_claims'
ORDER BY ordinal_position;
```

### √âtape 4: Ex√©cuter le script
1. Cliquez sur le bouton **"Run"** (en bas √† droite)
2. Vous devriez voir un message de succ√®s
3. En bas, vous verrez la liste des colonnes de la table `business_claims`

### √âtape 5: V√©rifier que √ßa fonctionne
Vous devriez voir ces colonnes dans le r√©sultat:
- ‚úÖ `user_email`
- ‚úÖ `user_name`
- ‚úÖ `user_phone`
- ‚úÖ `verification_method`
- ‚úÖ `verification_data`
- ‚úÖ `notes`

---

## R√©sultat attendu

Apr√®s l'ex√©cution, la table `business_claims` aura la structure compl√®te:

```
column_name          | data_type              | is_nullable
---------------------|------------------------|------------
id                   | uuid                   | NO
business_id          | uuid                   | NO
user_id              | uuid                   | NO
user_email           | character varying      | YES  ‚ú® AJOUT√âE
user_name            | character varying      | YES  ‚ú® AJOUT√âE
user_phone           | character varying      | YES  ‚ú® AJOUT√âE
verification_method  | character varying      | YES  ‚ú® AJOUT√âE
verification_data    | jsonb                  | YES  ‚ú® AJOUT√âE
notes                | text                   | YES  ‚ú® AJOUT√âE
status               | character varying      | YES
created_at           | timestamp              | YES
updated_at           | timestamp              | YES
```

---

## Test

Apr√®s avoir ex√©cut√© le script:

1. Retournez sur votre site web
2. Essayez de r√©clamer une fiche avec **"Demande manuelle"**
3. Remplissez le formulaire
4. Cliquez sur **"Soumettre la demande"**
5. ‚úÖ √áa devrait fonctionner sans erreur!

---

## Note

Le script utilise `IF NOT EXISTS`, donc vous pouvez l'ex√©cuter plusieurs fois sans probl√®me. Si une colonne existe d√©j√†, elle ne sera pas modifi√©e.

---

**Une fois le script ex√©cut√©, la r√©clamation de fiche fonctionnera parfaitement!** üéØ
